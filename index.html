<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Energy Booster AI</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script type="importmap">
        {
            "imports": {
                "react": "https://esm.sh/react@18.2.0",
                "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
                "lucide-react": "https://esm.sh/lucide-react@0.263.1"
            }
        }
    </script>
    <script type="module" src="https://esm.sh/run" defer></script>
    <style>
        /* Custom scrollbar for cleaner look */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background-color: #fca5a5; border-radius: 20px; }
    </style>
</head>
<body class="bg-orange-50">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { Send, Zap, Sparkles, Globe } from 'lucide-react';

        const EnergyApp = () => {
            const [messages, setMessages] = useState([]);
            const [inputValue, setInputValue] = useState('');
            const [isTyping, setIsTyping] = useState(false);
            const [lang, setLang] = useState('en'); 
            const messagesEndRef = useRef(null);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages, isTyping]);

            useEffect(() => {
                const greeting = lang === 'en' 
                    ? "Hi there! I'm your Energy Bot. I'm here to hype you up! Tell me, how are you feeling right now?"
                    : "ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„èƒ½é‡åŠ©æ‰‹ã€‚æˆ‘æ˜¯æ¥ä¸ºä½ åŠ æ²¹çš„ï¼å‘Šè¯‰æˆ‘ï¼Œä½ ç°åœ¨æ„Ÿè§‰å¦‚ä½•ï¼Ÿ";
                
                setMessages([{ id: 1, text: greeting, sender: 'bot' }]);
            }, [lang]);

            const callGemini = async (userText) => {
                const apiKey = "AIzaSyBMp80yIlcYGDjocpqfxipHm4XLSKLwql4"; // âš ï¸ ç³»ç»Ÿä¼šåœ¨è¿è¡Œæ—¶è‡ªåŠ¨å¡«å…¥ Keyï¼Œæˆ–è€…ä½ å¯ä»¥æ‰‹åŠ¨å¡«å…¥
                // æ³¨æ„ï¼šå¦‚æœæ˜¯åœ¨çº¯é™æ€ç½‘é¡µéƒ¨ç½²ï¼Œå»ºè®®é€šè¿‡ Vercel åç«¯è½¬å‘ï¼Œæˆ–ä»…ç”¨äºä¸ªäººæµ‹è¯•
                
                const systemPrompt = `You are a high-energy, supportive AI personal cheerleader. 
                Your goal is to hype the user up, validate their feelings, and provide energy.
                If the user speaks Chinese, reply in Chinese. If English, reply in English.
                Keep responses short, punchy, and under 3 sentences. Use enthusiastic emojis like ğŸ”¥, ğŸ’ª, ğŸš€.`;

                try {
                    const response = await fetch(
                        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,
                        {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify({
                                contents: [{ parts: [{ text: userText }] }],
                                systemInstruction: { parts: [{ text: systemPrompt }] },
                            }),
                        }
                    );

                    if (!response.ok) throw new Error("API Error");

                    const data = await response.json();
                    return data.candidates?.[0]?.content?.parts?.[0]?.text || (lang === 'en' ? "You've got this!" : "åŠ æ²¹ï¼");
                } catch (error) {
                    console.error("AI Request Failed:", error);
                    return lang === 'en' 
                        ? "I'm having trouble connecting, but know this: You are amazing! Keep pushing! ğŸ’ª" 
                        : "è¿æ¥æœ‰ç‚¹é—®é¢˜ï¼Œä½†è¯·è®°ä½ï¼šä½ æ˜¯æœ€æ£’çš„ï¼ç»§ç»­åŠ æ²¹ï¼ğŸ’ª";
                }
            };

            const handleSend = async () => {
                if (!inputValue.trim()) return;

                const userMsg = { id: Date.now(), text: inputValue, sender: 'user' };
                setMessages(prev => [...prev, userMsg]);
                setInputValue('');
                setIsTyping(true);

                const botResponseText = await callGemini(userMsg.text);
                
                const botMsg = { id: Date.now() + 1, text: botResponseText, sender: 'bot' };
                setMessages(prev => [...prev, botMsg]);
                setIsTyping(false);
            };

            const handleKeyDown = (e) => {
                if (e.key === 'Enter') handleSend();
            };

            const toggleLang = () => {
                setLang(prev => prev === 'en' ? 'cn' : 'en');
                setMessages([]); 
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-orange-100 via-yellow-50 to-orange-100 flex items-center justify-center p-4 font-sans text-slate-800">
                    <div className="w-full max-w-md bg-white rounded-3xl shadow-2xl overflow-hidden flex flex-col h-[80vh] border-4 border-yellow-400">
                        {/* Header */}
                        <div className="bg-gradient-to-r from-orange-400 to-yellow-400 p-4 flex items-center justify-between shadow-md">
                            <div className="flex items-center gap-2 text-white font-bold text-xl">
                                <Zap className="fill-current text-yellow-100 animate-pulse" />
                                <span>{lang === 'en' ? 'Energy Booster' : 'èƒ½é‡åŠ æ²¹ç«™'}</span>
                            </div>
                            <button onClick={toggleLang} className="text-white hover:bg-white/20 p-2 rounded-full transition-colors flex items-center gap-1 text-xs font-bold">
                                <Globe size={16} />
                                {lang === 'en' ? 'CN' : 'EN'}
                            </button>
                        </div>

                        {/* Chat Area */}
                        <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-white/50 relative">
                            {messages.map((msg) => (
                                <div key={msg.id} className={`flex ${msg.sender === 'user' ? 'justify-end' : 'justify-start'}`}>
                                    <div className={`max-w-[80%] p-3 rounded-2xl shadow-sm text-sm leading-relaxed ${
                                        msg.sender === 'user' ? 'bg-orange-500 text-white rounded-tr-none' : 'bg-white border border-yellow-200 text-slate-700 rounded-tl-none'
                                    }`}>
                                        {msg.text}
                                    </div>
                                </div>
                            ))}
                            {isTyping && (
                                <div className="flex justify-start">
                                    <div className="bg-white border border-yellow-200 p-3 rounded-2xl rounded-tl-none shadow-sm flex items-center gap-1">
                                        <span className="w-2 h-2 bg-orange-400 rounded-full animate-bounce"></span>
                                        <span className="w-2 h-2 bg-orange-400 rounded-full animate-bounce delay-75"></span>
                                        <span className="w-2 h-2 bg-orange-400 rounded-full animate-bounce delay-150"></span>
                                    </div>
                                </div>
                            )}
                            <div ref={messagesEndRef} />
                        </div>

                        {/* Quick Actions */}
                        <div className="p-2 bg-yellow-50 flex gap-2 overflow-x-auto justify-center">
                            <button onClick={() => setInputValue(lang === 'en' ? "I'm so tired..." : "æˆ‘å¥½ç´¯...")} className="whitespace-nowrap px-3 py-1 bg-white border border-yellow-300 text-orange-600 rounded-full text-xs font-semibold hover:bg-yellow-100 transition">
                                {lang === 'en' ? 'ğŸ˜´ Tired' : 'ğŸ˜´ å¥½ç´¯'}
                            </button>
                            <button onClick={() => setInputValue(lang === 'en' ? "I need motivation!" : "æˆ‘éœ€è¦åŠ¨åŠ›ï¼")} className="whitespace-nowrap px-3 py-1 bg-white border border-yellow-300 text-orange-600 rounded-full text-xs font-semibold hover:bg-yellow-100 transition">
                                {lang === 'en' ? 'ğŸ’ª Motivate Me' : 'ğŸ’ªä»¥æ­¤æ¿€åŠ±'}
                            </button>
                        </div>

                        {/* Input Area */}
                        <div className="p-4 bg-white border-t border-yellow-100">
                            <div className="flex gap-2">
                                <input type="text" value={inputValue} onChange={(e) => setInputValue(e.target.value)} onKeyDown={handleKeyDown} placeholder={lang === 'en' ? "Type here..." : "è¾“å…¥..."} className="flex-1 bg-slate-50 border border-slate-200 text-slate-700 rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400 transition-all" />
                                <button onClick={handleSend} disabled={!inputValue.trim()} className="bg-gradient-to-r from-orange-500 to-yellow-500 text-white p-2 rounded-full shadow-lg hover:shadow-orange-300/50 transition-all disabled:opacity-50">
                                    <Send size={20} className="ml-0.5" />
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<EnergyApp />);
    </script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</body>

</html>
